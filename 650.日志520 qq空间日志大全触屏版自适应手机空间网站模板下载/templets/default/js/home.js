var client_ip=typeof client_ip=="#"?"#":client_ip;(function(){$(function(){function backTop(){var oBackTop=$(".j_backTop");if(oBackTop.length>0){oBackTop.click(function(){window.scrollTo(0,0)})}}function addOnscroll(fn){if(typeof window.onscroll=="function"){var tempFn=window.onscroll;window.onscroll=function(){tempFn();fn()}}else{window.onscroll=function(){fn()}}}function createScript(url){var head=document.getElementsByTagName("head")[0],script=document.createElement("#");script.src=url;script.charset="utf-8";head.appendChild(script)}function topWeiboRemind(){if(document.querySelector("#j_weibo_remind")!=null){if(!sid||!gsid){return false}var url="http://api.weibo.cn/interface/f/ttt/v3/getunreadnum.php?type=js&c=sina_cn&s="+sid+"&unixtimestamp="+timestamp+"&gsid="+gsid+"&callback=weiboRemindCallback";createScript(url)}}window.weiboRemindCallback=function(data){if(typeof data.errno!="undefined"){return false}else{var oRemind=document.querySelector("#j_weibo_remind"),count=parseInt(data.comment)+parseInt(data.message)+parseInt(data.notice)+parseInt(data.atmsg)+parseInt(data.atcmt)+parseInt(data.newfans);if(count>0){count=(count>99)?"99+":count;oRemind.innerHTML=count;oRemind.style.display="block"}}};function photosSlide(id){var oContainer=$("#"+id+" .swiper-container");if(oContainer.length>0){var src="",len=0,index=0,oImgs=null,curImg=null;var mySwiper=oContainer.swiper({pagination:"#"+id+" .pagination",loop:true,speed:600,autoplay:4000,keyboardControl:true,mousewheelControl:true,paginationClickable:true,onSlideChangeEnd:function(){for(var i=0;i<len;i++){curImg=oImgs.eq(i);if(curImg.length>0&&(curImg.attr("data-imgdelay")!=1)){src=curImg.attr("data-src");if(src&&src!=""){curImg.attr("src",src)}curImg.attr("data-imgdelay","1")}}}});oImgs=oContainer.find("img.img");len=oImgs.length;index=mySwiper.activeIndex;curImg=oImgs.eq(index-1);if(curImg.length>0&&(curImg.attr("data-imgdelay")!=1)){src=curImg.attr("data-src");if(src&&src!=""){curImg.attr("src",src)}curImg.attr("data-imgdelay","1")}}}function photosSlideInit(){var oSwipes=$(".j_ptotos_swiper"),len=oSwipes.length;if(len==0){return false}var i,id="";for(i=0;i<len;i++){id="j_photos_swiper_"+i;oSwipes.eq(i).attr("id",id);photosSlide(id)}}function imgDelay(){var area=$(".j_imgdelay"),areaLen=area.length,loadCount=0;if(areaLen==0){return false}var viewHeight=document.documentElement.clientHeight;viewHeight=viewHeight*2;function loadingImg(){if(loadCount>=areaLen){return false}for(var i=0;i<areaLen;i++){var currObj=area.eq(i);if(currObj.data("imgdelay")===1){continue}var scrollY=document.body.scrollTop||document.documentElement.scrollTop,maxHeight=viewHeight+scrollY;if(currObj.offset().top<maxHeight){var oImg=currObj.find("img"),imgLen=oImg.length;for(var j=0;j<imgLen;j++){var currImg=oImg.eq(j);currImg.attr("src",currImg.data("src"))}currObj.data("imgdelay","1");loadCount=loadCount+1}}}var timer;addOnscroll(function(){if(timer){clearTimeout(timer);timer=null}timer=setTimeout(loadingImg,200)})}function initMarquee(flag){var startmarquee=null;startmarquee=function(lh,speed,delay){var o=document.getElementById("marqueebox"),oLis=$(o).find("li");if(oLis.length<2){return false}var t=null,start=null,scrolling=null,p=false;if(flag&&(flag=="init")){o.innerHTML+=o.innerHTML}o.scrollTop=0;start=function(){t=setInterval(scrolling,speed);if(!p){o.scrollTop+=1}};scrolling=function(){if((o.scrollTop%lh)!=0){o.scrollTop+=1;if(o.scrollTop>=o.scrollHeight/2){o.scrollTop=0}}else{if(t){clearInterval(t);t=null}setTimeout(start,delay)}};setTimeout(start,delay)};startmarquee(34,10,3000)}window.onpageshow=function(){setTimeout(function(){initMarquee()},0)};setTimeout(function(){photosSlideInit();imgDelay();backTop();initMarquee("init")},300);setTimeout(function(){topWeiboRemind();lejuData()},1000);function lejuData(){var url=""+client_ip;createScript(url)}var picsObj=$("#j_leju_pics"),newsObj=$("#j_leju_news"),linkObj=$("#j_leju_link");window.LejuDataCallback=function(data){if(data.status=="1"){var pics=data.data.pics,news=data.data.news,str="";if(pics&&pics.length>0){for(i=0;i<pics.length;i++){str+='<li><a href="'+pics[i].link+'" title="'+pics[i].title+'"><img src="'+pics[i].src+'" alt="'+pics[i].title+'"/><h3 class="p_piclistbox_h3">'+pics[i].title+"</h3></a></li>"}}picsObj.html(str);if(news&&news.length==8){for(i=0,str="";i<4;i++){str+='<li><a href="'+news[i].link+'">'+news[i].title+"</a></li>"}newsObj.html(str);var len=0;for(i=4,str="";i<news.length;i++){if(len+news[i].title.length<16&&news[i].link!=""&&news[i].title!=""){str+='<a href="'+news[i].link+'">'+news[i].title+"</a>";len+=news[i].title.length}}linkObj.html(str)}else{if(news&&news.length==6){for(i=0,str="";i<2;i++){str+='<li><a href="'+news[i].link+'">'+news[i].title+"</a></li>"}newsObj.html(str);var len=0;for(i=2,str="";i<news.length;i++){if(len+news[i].title.length<16&&news[i].link!=""&&news[i].title!=""){str+='<a href="'+news[i].link+'">'+news[i].title+"</a>";
len+=news[i].title.length}}linkObj.html(str)}}}}})})();